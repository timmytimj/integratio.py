{  
    "$schema":"http://json-schema.org/draft-04/schema#",
    "id":"http://marcozunino.it/integratio#",
    "type":"object",
    "properties":{  
        "test-id":{  
            "type":"string"
        },
        "interface":{  
            "type":"string"
        },
        "tcp-port":{  
            "type":"number"
        },
        "dns-port":{
            "type":"number"
        },
        "configs":{  
            "type":"array",
            "items":{  
                "title":"TestConf",
                "type":"object",
                "anyOf":[  
                    {  
                        "$ref":"#/definitions/tcz-conf"
                    },
                    {  
                        "$ref":"#/definitions/icmz-conf"
                    },
                    {  
                        "$ref":"#/definitions/dns-conf"
                    },
                    {  
                        "$ref":"#/definitions/time-conf"
                    },
                    {  
                        "$ref":"#/definitions/content-conf"
                    }
                ]
            }
        }
    },
    required:["tcp-port", "interface", "configs"],
    "definitions":{  
        "tcz-conf":{  
            "type":"object",
            "properties":{  
                "category":{  
                    "type":"string",
                    "enum":[  
                        "packet"
                    ]
                },
                "parameters":{  
                    "type":"array",
                    "items":{  
                        "type":"object",
                        "properties":{  
                            "sub-category":{  
                                "type":"string",
                                "enum":["tcz"]
                            },
                            "state":{  
                                "type":"string"
                            },
                            "action":{  
                                "type":"string"
                            },
                            "flags":{  
                                "type":"string"
                            }
                        },
                        "required":[  
                            "sub-category",
                            "state",
                            "action",
                            "flags"
                        ]
                    }
                }
            }
        },
        "icmz-conf":{  
            "type":"object",
            "properties":{  
                "category":{  
                    "type":"string",
                    "enum":[  
                        "packet"
                    ]
                },
                "parameters":{  
                    "type":"array",
                    "items":{  
                        "type":"object",
                        "properties":{  
                            "sub-category":{  
                                "type":"string",
                                "enum":["icmz"]
                            },
                            "state":{  
                                "type":"string"
                            },
                            "action":{  
                                "type":"string"
                            },
                            "type":{  
                                "type":"number"
                            },
                            "code":{
                                "type":"number"
                            }
                        },
                        "required":[  
                            "sub-category",
                            "state",
                            "action",
                            "type",
                            "code"
                        ]
                    }
                }
            }
        },
        "dns-conf":{  
            "type":"object",
            "properties":{  
                "category":{  
                    "type":"string",
                    "enum":[  
                        "dns"
                    ]
                },
                "parameters":{  
                    "type":"array",
                    "items":{  
                        "type":"object",
                        "properties":{  
                            "q-addr":{  
                                "type":"string"
                            },
                            "response":{  
                                "type":"string"
                            }
                        },
                        "required":[  
                            "q-addr",
                            "response"
                        ]
                    }
                }
            }
        },
        "time-conf":{  
            "type":"object",
            "properties":{  
                "category":{  
                    "type":"string",
                    "enum":[  
                        "time"
                    ]
                },
                "parameters":{  
                    "type":"array",
                    "items":{  
                        "type":"object",
                        "properties":{  
                            "state":{  
                                "type":"string"
                            },
                            "action":{  
                                "type":"string"
                            },
                            "delay":{  
                                "type":"number"
                            }
                        },
                        "required":[  
                            "action",
                            "state",
                            "delay"
                        ]
                    }
                }
            }
        },
        "content-conf":{  
            "type":"object",
            "properties":{  
                "category":{  
                    "type":"string",
                    "enum":[  
                        "content"
                    ]
                },
                "parameters":{  
                    "type":"array",
                    "items":{  
                        "type":"object",
                        "properties":{  
                            "resource":{  
                                "type":"string"
                            },
                            "http-status":{  
                                "type":"string"
                            },
                            "body":{  
                                "type":"string"
                            },
                            "headers":{  
                                "type":"string"
                            }
                        },
                        "required":[  
                            "body",
                            "headers",
                            "http-status",
                            "resource"
                        ]
                    }
                }
            }
        }
    }
}
